<!doctype html>
<html>
	<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Machine Learning at the Belle II Experiment</title>

		<meta name="description" content="PhD Thesis">
		<meta name="author" content="Thomas Keck">

		<link rel="stylesheet" href="../reveal.js/css/reveal.css">
		<link rel="stylesheet" href="../reveal.mod/css/theme/current.css">
		<link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
    <style>
    .underground
    {
      background: rgba(22, 22, 22, .90);
    }

    .rotate {
        -ms-transform: rotate(90deg); /* IE 9 */
        -webkit-transform: rotate(90deg); /* Chrome, Safari, Opera */
        transform: rotate(90deg);
    }

    #arrow-wrapper {
           width: 80vw;
           height: 6vh;
           float: left;
    }
    #arrow-stem {
      background: transparent;
      width: 40vw;
      border-bottom: 3vh solid var(--default-color);
      margin-top: 1.5vh;
      margin-left: 1vw;
      float: left;
    }
    #arrow-head {
      border-top: 3vh solid transparent;
      border-left: 5vw solid var(--default-color);
      border-bottom: 3vh solid transparent;
      margin-right: 1vw;
      float: left;
     }
    </style>

	</head>
	<body>
		<div class="reveal">
			<div class="slides" style="height: 100%">
				<section style="height: 100%">
          <section>
            <h1>Machine Learning algorithms for the Belle II experiment and their validation on Belle data</h1>

            <p>
            Thomas Keck (<a href="mailto:t.keck@online.de">t.keck@online.de</a>)
            </p>
          
          </section>
				<section data-background-image="images/Karlsruhe.jpg" data-background-size="100%" style="height: 100%">
          <h2>KIT</h2>
          <p class="fragment" style="width: 100%; height: 70vmin">
            <img data-src="images/etp.png">
          </p>
        </section>
				<section data-background-image="images/Karlsruhe.jpg" data-background-size="100%" style="height: 100%">
          <h2>KIT</h2>
          <p style="width: 100%; height: 70vmin">
            <img data-src="images/etp2.png">
          </p>
        </section>
				<section>
          <h2>SuperKEKB</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/SuperKEKB.jpg" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>SuperKEKB / Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/belle2.jpg" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/Detector.jpg" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/belle2_sideview.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				
          
				<section>
          <h2>First Collisions at Belle II (26.05.2018)</h2>
          
          <div style="display: flex; width: 100%;">
          <div style="float: left; width: 50%; height: 70vmin">
            <img data-src="images/first_collisions_control_room.jpg" style="background:none; border:none; box-shadow:none; height: 100%; width: auto; object-fit: contain;">
          </div>
          <div style="float: left; width: 50%; height: 70vmin">
            <img data-src="images/first_collision.png" style="background:none; border:none; box-shadow:none; height: 100%; width: auto; object-fit: contain;">
          </div>
          </div>
				</section>
        
        <section>
          <h2>B Mesonen</h2>

            <div style="height: 5vmin"></div>
          <div style="width: 100%; height: 60vmin">
            <img data-src="images/event_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
          <div style="font-size: 5vmin">
          </div>
          $$ \Upsilon(\mathrm{4S}) \rightarrow \mathrm{B} \bar{\mathrm{B}} $$
        </section>
          
        <section>
            <h2>B Meson Decay</h2>
            <div style="height: 5vmin"></div>
            <div style="width: 100%; height: 70vmin">
              <img data-src="images/fei_transparent_inverted.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
          </section>
				<section>
          <h2>B Meson</h2>

            <div style="height: 5vmin"></div>
          <div style="width: 100%; height: 80vmin">
          <iframe data-src="images/rpp2016-tab-mesons-bottom.pdf" type="application/pdf" frameborder="0" width="100%" height="100%"></iframe>
          </div>
        </section>
				<section>
          <h2>Simple Analogy: Uranium</h2>

          <div style="width: 100%; height: 80vmin">
            <img data-src="images/u235.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
        </section>
        
        <section style="height: 100%">
				<section>
          <h1>Machine Learning at Belle II</h1>
				</section>
				<section>
          <h2>Data Acquisition</h2>
          <div style="display: flex; width: 100%;">
          <div style="float: right; width: 70%; height: 60vmin">
            <img src="images/cdc.jpg" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
          <div style="float: right; width: 30%; height: 60vmin">
            <img data-src="images/fpgaboard.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
          </div>
        </section>
				<section>
          <h2>Event Reconstruction</h2>
          <div style="height: 75vmin">
            <img data-src="images/tracking.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Data Analysis</h2>
          <div style="height: 75vmin">
            <img data-src="images/flavortaggerdeep.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
        </section>
        </section>
        
        <section style="height: 100%">
          <section>
            <h1>Full Event Interpretation</h1>
          </section>
          
          <section>
          <h2>Idea</h2>

            <div style="height: 5vmin"></div>
          <b>Each event contains exactly two B Mesons</b>
          <div style="width: 100%; height: 60vmin">
            <img data-src="images/event_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
          <div style="font-size: 5vmin">
          $$ \Upsilon(\mathrm{4S}) \rightarrow \mathrm{B} \bar{\mathrm{B}} $$
          </div>
          </section>
				
          <section>
          <h2>Idea</h2>

            <div style="height: 5vmin"></div>
          <b>Automatically reconstruct one out of the two B Mesons</b>
          <div style="width: 100%; height: 60vmin">
            <img data-src="images/event_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
          <div style="font-size: 5vmin">
            $$ \mathrm{B}^- \rightarrow \mathrm{D^{0\star}} \mathrm{D}^- \mathrm{K}^0_\mathrm{s} \rightarrow \dots \rightarrow 2 \mathrm{K}\ 7 \pi\ 4 \gamma$$
          </div>
          Over 10000 possible chains are considered!
          </section>
          
          <section>
          <h2>Idea</h2>

            <div style="height: 5vmin"></div>
          <b>Rest of Event is another B meson!</b>
          <div style="width: 100%; height: 60vmin">
            <img data-src="images/event_cleaned.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
          <div style="font-size: 5vmin">
          $$ \mathrm{B}^+ \rightarrow \tau^+ \nu \rightarrow \mu^+ \nu \nu \nu $$
          </div>
          Rare decay, only accessible at a B factory!
          </section>

          <section>
            <h2>Hierarchical Reconstruction</h2>
            <div style="height: 5vmin"></div>
            <div style="width: 100%; height: 60vmin">
              <img data-src="images/fei_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            <p class="fragment">
             One BDT for each decay-channel $\rightarrow$ Currently $177$ BDTs
            </p>
          </section>
          
          <section style="height: 100%">
            <h2>Simple Analogy: Image Recognition</h2>

            <div style="height: 30vmin">
            <img data-src="images/inception_global_vertical.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            <div id="arrow-wrapper">
              <div style="float: left; margin-left: 5vw; width: 10vw; font-size: 5vmin;">Pixels</div>
              <div id="arrow-stem"></div>
              <div id="arrow-head"></div>
              <div style="float: left; width: 10vw; font-size: 5vmin;">Objects</div>
            </div>

          <div class="fig-container fragment"
                   data-fig-id="convolution"
                   data-file="animations/image_recognition.html" style="width: 100%; height: 50%"></div>
          </section>
          
          <section style="height: 100%">
            <h2>Simple Analogy: Image Recognition</h2>
            
            <div style="height: 30vmin">
            <img data-src="images/fei_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            <div id="arrow-wrapper">
              <div style="float: left; margin-left: 5vw; width: 10vw; font-size: 5vmin;">Data</div>
              <div id="arrow-stem"></div>
              <div id="arrow-head"></div>
              <div style="float: left; width: 10vw; font-size: 5vmin;">Decays</div>
            </div>

            <div style="display: flex; width: 100%;">
            <div style="float: left; width: 50%; height: 45vmin">
              <img data-src="images/event_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            <div style="float: left; width: 50%; height: 45vmin">
              <div style="height: 2vmin"></div>
              <div class="fragment" style="text-align: left;">
              Probability 0.8
              <br>
              <div style="background: rgba(22, 22, 80, .90);">
                Tracks (1, 4, 6, ...) and  Clusters (3, 5, 10, ...)<br>
                $ \mathrm{B}^- \rightarrow \mathrm{D^{0\star}} \mathrm{D}^- \mathrm{K}^0_\mathrm{s} \rightarrow \dots \rightarrow 2 \mathrm{K}\ 7 \pi\ 4 \gamma $
              </div>
              </div>
              <div style="height: 2vmin"></div>
              <div class="fragment" style="text-align: left;">
              Probability 0.6
              <br>
              <div style="background: rgba(22, 22, 80, .90);">
                Tracks (2, 4, 7, ...) and Clusters (4, 5, 6, ...)<br>
                $ \mathrm{B}^- \rightarrow \mathrm{D^0} \pi^+ \pi^- \pi^- \rightarrow \dots \rightarrow 1 \mathrm{K}\ 4 \pi\ 2 \gamma$
              </div>
              </div>
              <div style="height: 2vmin"></div>
              <div class="fragment">
              $\dots$
              </div>
            </div>
            </div>
          </section>
          
          <section>
          <h2>Result</h2>
            <div style="height: 5vmin"></div>
            <div style="display: flex; width: 100%;">
            <div style="float: left; width: 50%; height: 50vmin">
              <img data-src="images/fei_comparison_transparent.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            <div style="float: left; width: 50%; height: 50vmin">
              <img data-src="images/fei_comparison_mbc_charged_loose.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
            </div>
            </div>

            Usable efficiency significantly improved and its faster in direct comparison!
          </section>
          
          <section>
            <h2>Runtime: FastBDT</h2>
            <div style="height: 5vmin"></div>
              Inference
              <br>
              <img data-src="images/fastbdt_inference.png" style='height: 50vh; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            <br>
            <div style="height: 5vmin"></div>
            Custom BDT implementation: fast, robust, HEP-specific features
          </section>
				
          <section>
            <h2>Runtime: FastBDT</h2>
            <div style="height: 5vmin"></div>
              Fitting
              <br>
              <img data-src="images/fastbdt_fit.png" style='height: 50vh; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            <br>
            <div style="height: 5vmin"></div>
            Custom BDT implementation is (originally) one order of magnitude faster
            <br>
            $\rightarrow$ efficient caching and equal-frequency binning

          </section>
          
        </section>
				
        
        <section style="height: 100%">
          <section>
            <h1>Deep Learning in HEP</h1>
          </section>
				
          <section>
          <h2>Data Driven Algorithms</h2>
          
            <div style="height: 5vmin"></div>
          <ol>
            <li>Train classifier on simulated events</li>
            <li>Apply classifier to recorded events</li>
          </ol>
            <div style="height: 2vmin"></div>
          <div class="fragment" style="height: 50vmin">
            <img data-src="images/MVABaseline.png" style="background:none; border:none; box-shadow:none;">
          </div>
            <div style="height: 5vmin"></div>
					<div class="fragment">Simulated Events and Recorded Events are NOT compatible</div>
        </section>
				<section>
          <h2>Data Driven Algorithms</h2>
            <div style="height: 5vmin"></div>
					<ol>
					<li> Train classifier A: recorded vs. simulated events </li>
					<li> Apply classifier A to simulated events </li>
					<li> Reweight simulated events: $ w = \frac{p}{1-p} $</li>
					<li> Train classifier B: simulated signal vs. background events </li>
					<li> Apply classifier B to recorded events </li>
					</ol>
            <div style="height: 2vmin"></div>
          <div style="height: 50vmin" class="fragment">
            <img data-src="images/MVAReweightedTotal.png" style="background:none; border:none; box-shadow:none;">
          </div>
        </section>
				<section>
          <h2>Uniformity Constraints</h2>
            
          <ol>
            <li>Train classifier using low-level features</li>
            <li>Apply classifier to increase signal-to-noise ratio</li>
            <li>Measure the resonance sub-structure</li>
          </ol>
            <div style="height: 2vmin"></div>
          <div style="display: flex; width: 100%;">
          <div style="float: left; width: 33%; height: 60vmin">
            Resonance Substructure
            <br>
            <img data-src="images/dalitz_plot_vertical.png" width="80%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 60vmin">
            <div style="width: 100%; height: 5vmin"></div>
            Selection Efficiency
            <br>
            <img data-src="images/tensorflow_baseline_dalitz_vertical.png" width="90%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 60vmin">
            <div style="width: 100%; height: 5vmin"></div>
            Feature Correlation Matrix
            <br>
            <img data-src="images/dmeson_correlation.png" width="90%" style="background:none; border:none; box-shadow:none;">
          </div>
          </div>
					<p class="fragment">
          Non-uniform selection efficiency creates artificial signals!
					</p>
        </section>
				
        <section>
          <h2>Adversarial Networks</h2>
          
          <div style="width: 100%; height: 40vmin">
            <img data-src="images/learning_to_pivot.png" style="background:none; border:none; box-shadow:none;">
          </div>
          <small><a href="https://arxiv.org/abs/1611.01046">G. Louppe, M. Kagan, K. Crammer</a></small>
          
          <div style="display: flex; width: 100%;">
          <div class="fragment" style="float: left; width: 33%; height: 40vmin">
            <img data-src="images/dalitz_plot_vertical.png" width="70%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 40vmin">
            <div style="width: 100%; height: 5vmin"></div>
            <img data-src="images/tensorflow_baseline_dalitz_vertical.png" width="80%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 40vmin">
            <div style="width: 100%; height: 5vmin"></div>
            <img data-src="images/tensorflow_dalitz_vertical.png" width="80%" style="background:none; border:none; box-shadow:none;">
          </div>
          </div>
        </section>
        
        <section>
          <h2>Adversarial Networks</h2>
          <div style="width: 100%; height: 70vmin">
					<img data-src="images/nn_uniform_roc.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
        </section>
        
        </section>
          
        <section style="height: 100%">
				<section>
          <h2>Questions and Answers</h2>

          <div style="height: 70vmin">
            <img data-src="images/first_collision.png" style="background:none; border:none; box-shadow:none; height: 100%; width: auto; object-fit: contain;">
          </div>
        </section>
				<section>
          <h2>References</h2>
					<ul>
					<li><a href="https://publikationen.bibliothek.kit.edu/1000078149">PhD Thesis Thomas Keck</a></li>
					<li><a href="http://ekp-invenio.physik.uni-karlsruhe.de/record/48849">Master Thesis Jochen Gemmler</a></li>
          <li><a href="http://iopscience.iop.org/article/10.1088/1742-6596/608/1/012048/meta">An automated framework for hierarchical reconstruction of B mesons at the Belle II experiment (C. Pulvermacher, T. Keck et al.)</li>
					<li><a href="https://link.springer.com/article/10.1007%2Fs41781-017-0002-8">FastBDT: A Speed-Optimized Multivariate Classification Algorithm for the Belle II Experiment (T. Keck)</a></li>
					<li><a href="http://iopscience.iop.org/article/10.1088/1742-6596/368/1/012028">Advanced event reweighting using multivariate analysis (D. Martschei et al.)</a></li>
					<li><a href="https://arxiv.org/abs/1611.01046">Learning to Pivot (G. Louppe et al.)</a></li>
					<li><a href="https://arxiv.org/abs/1206.2944">Practical Bayesian Optimization of Machine Learning Algorithms (J. Snoek et al.)</a></li>
					</ul>
        </section>
        <section>
            <h2>FastBDT</h2>
            <div style="width: 100%; height: 5vmin"></div>
            <div style="width: 100%; height: 30vmin">
              <img data-src="images/bdt_schema.png" style="background:none; border:none; box-shadow:none;">
            </div>
            <div style="width: 100%; height: 5vmin"></div>
            <div style="display: flex; width: 100%;">
            <div class="fragment" style="float: left; width: 47%; height: 40vmin">
              <b>Efficient caching (spatial, temporal)</b>
              <br>
              <img data-src="images/fastbdt_layout.png" style="background:none; border:none; box-shadow:none;">
            </div>
            <div style="float: right; width: 6%; height: 40vmin"></div>
            <div class="fragment" style="float: right; width: 47%; height: 40vmin">
              <b>Equal-frequency binning</b>
              <br>
              <img data-src="images/equal_frequency_binning.png" style="background:none; border:none; box-shadow:none;">
            </div>
            </div>
          </section>
          <section>
            <h2>Runtime: FastFit</h2>
            <div style="width: 100%; height: 60vmin">
              <img data-src="images/fitter_times.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            </div>
            Simple vertex fitter based on Eigen is one order of magnitude faster
          </section>
        <section data-background-image="images/cdc.jpg" data-background-size="80%">
          <div class="underground"><h2>Neuro Z Trigger</h2></div>
          <div class="fragment" style="width: 100%; height: 60vmin;">
           <img data-src="images/fpgaboard.png">
          </div>
          <div style="height: 5vh;"></div>
          <div class="fragment underground">
            <ul>
              <li>Virtex 6 vhx380 FPGA on Custom Board</li>
              <li>Identifies tracks originating in the interaction region</li>
              <li>280 nano-seconds per decision</li>
            </ul>
          </div>
        </section>
        <section>
          <h2>Traditional Flavour Tagger</h2>
          <div style="width: 100%; height: 70vmin">
          <img data-src="images/flavortaggercategories.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Deep Flavour Tagger</h2>
          <div style="width: 100%; height: 70vmin">
          <img data-src="images/flavortaggerdeep.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
          </div>
          Out-of-the-box superior to previous traditional algorithm
        </section>
				
        <section data-background-image="images/tsne/input.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer1.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer4.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer6.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer7.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer8.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer8_bbar.png" data-background-size="100vmin"></section>
        <section data-background-image="images/tsne/layer8_bbar_tag.png" data-background-size="100vmin"></section>
				<section>
          <h2>SuperKEKB</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/comp-lumi-1.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
        </section>
			</div>
		</div>

		<script src="../reveal.js/lib/js/head.min.js"></script>
		<script src="../reveal.js/js/reveal.js"></script>

		<script>
			Reveal.initialize({
        controlsTutorial: false,
        center: false,
        transition: 'fade',
        history: true,
        width: '80%',
        height: '100%',
        math: {
            mathjax: '../reveal.mod/plugin/MathJax/MathJax.js'
        }, 
				dependencies: [
          { src: '../reveal.mod/js/d3.v4.min.js' },
          { src: '../reveal.mod/plugin/reveal.js-d3js-plugin/d3js.js' },
					{ src: '../reveal.js/plugin/markdown/marked.js' },
					{ src: '../reveal.js/plugin/markdown/markdown.js' },
					{ src: '../reveal.js/plugin/notes/notes.js', async: true },
					{ src: '../reveal.js/plugin/math/math.js', async: true },
				]
			});
		</script>
	</body>
</html>
