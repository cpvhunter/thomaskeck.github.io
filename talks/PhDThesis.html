<!doctype html>
<html>
	<head>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Template</title>

		<meta name="description" content="PhD Thesis">
		<meta name="author" content="Thomas Keck">

		<link rel="stylesheet" href="../reveal.js/css/reveal.css">
		<link rel="stylesheet" href="../reveal.mod/css/theme/black.css">
		<link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

	</head>
	<body>
		<div class="reveal">
			<div class="slides" style="height: 100%">
				<section style="height: 100%">
          <section>
            <h1>Machine Learning at the Belle II Experiment</h1>

            <p>
            Thomas Keck (<a href="mailto:thomas.keck2@kit.edu">thomas.keck2@kit.edu</a>)
            </p>
          </section>
				<section data-background-image="images/Karlsruhe.jpg" data-background-size="100%" style="height: 100%">
          <h2>KIT</h2>
          <p class="fragment" style="width: 100%; height: 70vmin">
            <img data-src="images/etp.png">
          </p>
        </section>
				<section>
          <h2>Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/Detector.jpg" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/belle2_sideview.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
				<section>
          <h2>Belle II</h2>
          <div style="width: 100%; height: 80vmin">
            <img data-src="images/event.png" style='height: 100%; width: auto; object-fit: contain; background:none; border:none; box-shadow:none;'>
          </div>
        </section>
        </section>
        
        <section style="height: 100%">
          <section>
            <h1>Full Event Interpretation</h1>
          </section>
        </section>
				
        <section style="height: 100%">
          <section>
            <h1>Runtime Optimization</h1>
          </section>
          <section>
            <h2>Vertex Fitting</h2>
            <div style="height: 10vmin"></div>
            <div style="display: flex; width: 100%;">
            <div style="float: left; width: 50%; height: 50vmin">
              <img data-src="images/gridsearch.png">
            </div>
            <div style="float: right; width: 50%; height: 50vmin">
              <h3>From KFitter to FastFit</h3>
              <br>
              <ul>
              <li>Same algorithm based on a Kalman Filter</li>
              <li>Eigen library instead of HEP's custom solution ROOT</li>
              <li>Removed all boilerplate code and parametrization conversions</li>
              </ul>
            </div>
            </div>
          </section>
          <section>
            <h2>Vertex Fitting</h2>
            <div style="width: 100%; height: 80vmin">
              <img data-src="images/fitter_times.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            </div>
          </section>
          <section>
            <h2>Multivariate Classification</h2>
            <div style="height: 10vmin"></div>
            <div style="width: 100%; height: 60vmin">
              <img data-src="images/fei_transparent.png" style='background:none; border:none; box-shadow:none;'>
              <br>
              Over 100 Boosted Decision Trees!
            </div>
          </section>
          <section>
            <h2>FastBDT</h2>
            <div style="width: 100%; height: 5vmin"></div>
            <div style="width: 100%; height: 30vmin">
              <img data-src="images/bdt_schema.png" style="background:none; border:none; box-shadow:none;">
            </div>
            <div style="width: 100%; height: 5vmin"></div>
            <div style="display: flex; width: 100%;">
            <div class="fragment" style="float: left; width: 47%; height: 40vmin">
              <b>Efficient caching (spatial, temporal)</b>
              <br>
              <img data-src="images/fastbdt_layout.png" style="background:none; border:none; box-shadow:none;">
            </div>
            <div style="float: right; width: 6%; height: 40vmin"></div>
            <div class="fragment" style="float: right; width: 47%; height: 40vmin">
              <b>Equal-frequency binning</b>
              <br>
              <img data-src="images/equal_frequency_binning.png" style="background:none; border:none; box-shadow:none;">
            </div>
            </div>
          </section>
          <section>
            <h2>Multivariate Classification</h2>
            <div style="width: 100%; height: 80vmin">
              <img data-src="images/fastbdt_fit.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            </div>
          </section>
          <section>
            <h2>Multivariate Classification</h2>
            <div style="width: 100%; height: 80vmin">
              <img data-src="images/fastbdt_inference.png" style='height: 100%; width: auto; object-fit: contain;  background:none; border:none; box-shadow:none;'>
            </div>
          </section>
        </section>
        
        <section style="height: 100%">
          <section>
            <h1>Deep Learning in HEP</h1>
          </section>
				<section>
          <h2>3 key <font color="red">technologies</font></h2>
					<p>required to use Deep Learning in physics</p>
        </section>
				<section>
          <h2>Data Driven Algorithms</h2>
					<p>How-to reduce the dependency on simulated events</p>
          
          <div style="display: flex; width: 100%;">
          <div class="fragment" style="float: left; width: 50%; height: 50vmin">
            <img data-src="images/MVABaseline.png" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 50%; height: 50vmin">
            <img data-src="images/MVAReweightedTotal.png" style="background:none; border:none; box-shadow:none;">
          </div>
          </div>
					<div class="fragment">
					<ol>
					<li> Train classifier: recorded vs. simulated events </li>
					<li> Reweight simulated events: $ w = \frac{p}{1-p} $</li>
					<li> Train classifier: signal vs. background events </li>
					</ol>
					</div>
        </section>
				<section>
          <h2>Uniformity Constraints</h2>
					<p>How-to prevent the usage of certain information</p>
					
          <div style="display: flex; width: 100%;">
          <div class="fragment" style="float: left; width: 33%; height: 50vmin">
            <img data-src="images/dalitz_plot_vertical.png" width="80%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 50vmin">
            <img data-src="images/tensorflow_baseline_dalitz_vertical.png" width="85%" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: left; width: 33%; height: 50vmin">
            <img data-src="images/tensorflow_dalitz_vertical.png" width="85%" style="background:none; border:none; box-shadow:none;">
          </div>
          </div>
					<div class="fragment">
          <ul>
            <li>Adversarial Neural Network</li>
            <li>Boosting to Uniformity</li>
          </ul>
					</div>
        </section>
				
        <section>
          <h2>Adversarial Networks</h2>
          
          <div style="width: 100%; height: 50vmin">
            <img data-src="images/learning_to_pivot.png" style="background:none; border:none; box-shadow:none;">
          </div>
          <a href="https://arxiv.org/abs/1611.01046">G. Louppe, M. Kagan, K. Crammer</a>
          <div style="height:5vmin"></div>

          <b>Pivot Property</b><br>
          <div style="font-size: 6vmin">
          $$p(f(\vec{x}, \theta_f) = s |\vec{z}, c) = p(f(\vec{x}, \theta_f) = s |\vec{z}^\star, c)$$
          </div>
        </section>
        
        <section>
          <h2>H-parameter Optimization</h2>
					<p>How-to optimize the large amount of new h-parameters</p>
          <div style="width: 100%; height: 70vmin">
					<img data-src="images/nnparameters.png">
          </div>
        </section>
        <section>
          <h2>H-parameter Optimization</h2>
          <div style="display: flex; width: 100%;">
          <div class="fragment" style="float: left; width: 50%; height: 50vmin">
            <b>Traditional GridSearch</b>
            <br>
            <img data-src="images/gridsearch.png" style="background:none; border:none; box-shadow:none;">
          </div>
          <div class="fragment" style="float: right; width: 50%; height: 50vmin">
            <b>Bayesian Optimization</b>
            <br>
            <img data-src="images/bayes.png" style="background:none; border:none; box-shadow:none;">
          </div>
          </div>
        </section>
        </section>
			</div>
		</div>

		<script src="../reveal.js/lib/js/head.min.js"></script>
		<script src="../reveal.js/js/reveal.js"></script>

		<script>
			Reveal.initialize({
        controlsTutorial: false,
        center: false,
        transition: 'fade',
        history: true,
        width: '80%',
        height: '100%',
        math: {
            mathjax: '../reveal.mod/plugin/MathJax/MathJax.js'
        }, 
				dependencies: [
          { src: '../reveal.mod/js/d3.v4.min.js' },
          { src: '../reveal.mod/plugin/reveal.js-d3js-plugin/d3js.js' },
					{ src: '../reveal.js/plugin/markdown/marked.js' },
					{ src: '../reveal.js/plugin/markdown/markdown.js' },
					{ src: '../reveal.js/plugin/notes/notes.js', async: true },
					{ src: '../reveal.js/plugin/math/math.js', async: true },
					{ src: '../reveal.js/plugin/highlight/highlight.js', async: false, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
